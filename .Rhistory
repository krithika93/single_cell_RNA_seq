if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("airwat")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("airway")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("pheatmap")
require(BiocManager)
install.packages("airway")
install.packages("pheatmap")
install.packages("ggplot2")
require(DESeq2)
install.packages("apeglm")
install.packages("EnhancedVolcano")
install.packages("tidyverse")
install.packages("AnnotationDbi")
install.packages("AnnotationDbi")
install.packages("org.Hs.eg.db")
require(parathyroidSE)
df <- data("parathyroidGenesSE")
df
df
df <- colData(parathyroidGenesSE)
df
s <- df$sample
s
s <- as.character(df$sample)
s
s <- substring(df$sample, nchar(df$sample)
)
s <- substring(s, nchar(s))
s
s.Length
length(s)
df$s <- s
df
df <- df[which(df$s=="6"|df$s=="4"|df$s=="1"|df$s=="2"),]
df
df <- subset(df,select= -c(s))
df
df=df[(1,2,3,4,5,6,7,8)]
df=df[c(1,2,3,4,5,6,7,8)]
df
df=df[c(1,2,3,4,5,6,7,8),]
df
df$Comparision <- c("a","a","a","a","b","b","b","b")
df
dds <- DESeqDataSet(data,design = ~Comparision)
DESeq2::DESeqDataSet(df,design = ~Comparision)
require(DESeq2)
dds <- DESeqDataSet(data,design = ~Comparision)
dds <- DESeqDataSet(data,design = ~Comparision)
dds <- DESeqDataSet(df,design = ~Comparision)
DESeqDataSet(df,design = ~Comparision)
colData(parathyroidGenesSE) <- df
colData(parathyroidGenesSE)
colData(parathyroidGenesSE)$s <- s
colData(parathyroidGenesSE)
p <-coldata(parathyroidGenesSE)
p <-colData(parathyroidGenesSE)
df <- parathyroidGenesSE
colData(df) <- colData(df)[which(colData(df)$s=="6"|colData(df)$s=="4"|colData(df$s)=="1"|colData(df$s)=="2"),]
df1 <- colData(df)[which(colData(df)$s=="6"|colData(df)$s=="4"|colData(df$s)=="1"|colData(df$s)=="2"),]
df1 <- colData(df)
df1
df1 <- df1[which(df1$s=="6"|df1$s=="4"|df1$s=="1"|df1$s=="2"),]
df1
colData(df) <- df1
df1
df1
df$Comparision <- c("a","a","a","a","b","b","b","b")
colData<-df1
colData
subset(parathyroidGenesSE)
subset(parathyroidGenesSE,s=="6"|s="4"|s="1"|s="2")
subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
colData(parathyroidGenesSE)
df1 <- subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
df1
df1 =subset(df,select= -c(s))
df1 <- subset(df1,select= -c(s))
df1 <- subset(colData(df1),select= -c(s))
df1
df1 <- subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
df1
colData(df1)
subset(parathyroidGenesSE,colData(s)=="6"|colData(s)=="4"|colData(s)=="1"|colData(s)=="2")
subset(parathyroidGenesSE,colData(s)=="6"|colData(s)=="4"|colData(s)=="1"|colData(parathyroidGenesSE)$s=="2")
df1
assay(df1)$counts
assay(parathyroidGenesSE)$counts
assay(parathyroidGenesSE)
subset(colData(parathyroidGenesSE),s=="6"|s=="4"|s=="1"|s=="2")
colData(df1) <- subset(colData(parathyroidGenesSE),s=="6"|s=="4"|s=="1"|s=="2")
ds <- subset(colData(parathyroidGenesSE),s=="6"|s=="4"|s=="1"|s=="2")
df
ds
df1
df1[,df1$s =="6"|df1$s =="4"| df$s =="1" | df$s == "2"]
df1 <- df1[,df1$s =="6"|df1$s =="4"| df$s =="1" | df$s == "2"]
df1
assay(df1)$counts
assay(df1)
df1
colData(df1)
df1 <- df1[1:8,]
df1
colData(df1)
df1 <- df1[c(1,2,3,4,5,6,7,8),]
colData(df1)
colData(df1) <- colData(df1)[c(1,2,3,4,5,6,7,8),]
df2 <- df1[1,]
colData(df2)
df2
df2[1]
df2 <- df1[c(1,2,3,4,5,6,7,8),]
df2
colData(df2)
df1
rownames(df1)
rownames(df2)
RowRanges(df1)
rowRanges(df1)
colData(df1)
colData(df1)$s
df1 <- df1[1:8,]
df1
dim(df)
colData(df1)
dim(df1)
dim(colData(df1))
colData(df1) <- subset(colData(df1),)
dim(colData(df1))
colData(df1) <- subset(colData(df1)[1:8],)
dim(colData(df1))
colData(df1)
colData(df1) <- subset(colData(df1)[1:8],c(1,2,3,4,5,6,7,8))
colData(df1)
colData(df1) <- colData(df1)[c(1,2,3,4,5,6,7,8),]
colData(df1) <- colData(df1)[]
colData(df1) <- colData(df1)[,]
colData(df1)
colData(df1) <- colData(df1)[,1:8]
colData(df1)
colData(df1) <- colData(df1)[1:8,1:8]
colData(df1) <- colData(df1)[1:8,]
colData(df1)[1:8,]
colData(df1)$index
df1 <- subset(df1,c=-(9))
df1
colData(df1)
df1[c("1","2","3","4","5","6","7","8")]
colData(df1)[c("1","2","3","4","5","6","7","8")]
df1 <- df1[1:8,]
df1
colData(df1)
df1$Comparision <- c("a,"a","a","a","b","b","b","b")
colData(df1)$Comparision <- c("a,"a","a","a","b","b","b","b")
colData(df1)
df1
colData(df1)[1:8,]
df2 <- colData(df1)[1:8,]
df1 <- filter(df1, df1$sample != SRS308886)
df1$sample <- as.character(df1$sample)
df1 <- filter(df1, df1$sample != SRS308886)
df1 <- filter(df1, df1$sample != "SRS308886)
df1 <- filter(df1, df1$sample != "SRS308886)
df1 <- filter(df1, df1$sample != "SRS308886")
df1
colDATA(df1)
colData(df1)
df1 <- df1[,df1$sample != "SRS308886"]
df1
colData(df1)
df2 <- colData(df1)
df1$Comparision <- c("a","a","a","a","b","b","b","b","b")
df1
colData(df1)$Comparision <- c("a","a","a","a","b","b","b","b","b")
colData(df1)$Comparision
df1$Comparision <- c("a","a","a","a","b","b","b","b")
df1
colData(df1)
df1$sample <-as.factor(df$sample)
df1$sample <-as.factor(df1$sample)
df1
colData(df1)
dds <- DESeqDataSet(data, design = ~Comparison)
dds <- DESeqDataSet(df1, design = ~Comparison)
dds <- DESeqDataSet(df1, design = ~Comparision)
dds
nrow(dds)
keep <- keep <- rowSums(counts(dds)) > 1
keep <- rowSums(counts(dds)) > 1
dds <- dds[keep,]
nrow(dds)
rld <- rlog(dds,blind = F)
rld
topVarGenes <- head(order(-rowVars(assay(rld))),100)
topVarGenes
require(pheatmap)
heatmap.2(x=assay(rld)[topVarGenes,])
par(mfrow=c(1,2))
boxplot(counts(dds),ylim =c(0,2000))
boxplot(assay(rld))
par(mfrow=c(1,1))
pheatmap(topVarGenes,scale = 'row')
install.packages("gplots")
heatmap.2(x=assay(rld)[topVarGenes,])
library(gplots)
heatmap.2(x=assay(rld)[topVarGenes,])
rld <- rlog(dds,blind = F)
topVarGenes <- head(order(-rowVars(assay(rld))),100)
rld <- rlog(dds,blind = F)
heatmap.2(x=assay(rld)[topVarGenes,])
dds1 <- DESeq(dds1)
dds1 <- DESeq(dds)
results(dds1,contrast = ("Comparision","a","b"))
dds1
colData(dds1)
results(dds1,contrast = ("Comparision","a","b"))
results(dds1,contrast = c("Comparision","a","b"))
res <- results(dds1,contrast = c("Comparision","a","b"))
res
sub <- subset(res,log2FoldChange > 2 & padj < 0.05)
sub
res
EnhancedVolcano(res, lab = rownames(res), x= 'log2FoldChange', y='pvalue',)
require("EnhancedVolcano")
EnhancedVolcano(res, lab = rownames(res), x= 'log2FoldChange', y='pvalue',)
EnhancedVolcano(res, lab = rownames(res), x= 'log2FoldChange', y='pvalue',)
library(gplots)
EnhancedVolcano(res, lab = rownames(res), x= 'log2FoldChange', y='pvalue',)
dev.off()
EnhancedVolcano(res, lab = rownames(res), x= 'log2FoldChange', y='pvalue',)
rowNames(res)
rownames(res)
getwd()
readfile <- read.csv("enrichment.csv")
readfile
readfile <- read.csv("enrichment_all.csv")
readfile
savehistory("C:/Users/rkrit/Documents/RNA_Seq/RNA_Seq/markdown.Rhistory")
install.packages("rmarkdown)
")"
c
install.packages("rmarkdown")
library(rmarkdown)
library(rmarkdown)
knitr::opts_chunk$set(echo = TRUE)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("DESeq2")
df <- data("parathyroidGenesSE")
s <- as.character(df$sample)
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
knitr::opts_chunk$set(echo = TRUE)
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- data("parathyroidGenesSE")
s <- as.character(df$sample)
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- data("parathyroidGenesSE")
s <- as.character(df$sample)
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- data("parathyroidGenesSE")
s <- df$sample
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- data("parathyroidGenesSE")
df
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- colData("parathyroidGenesSE")
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- colData(parathyroidGenesSE)
s <- as.character(df$sample)
s <- substring(s, nchar(s))
colData(parathyroidGenesSE)$s <- s
df1 <- subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
df1 <- df1[,df1$s =="6"|df1$s =="4"| df$s =="1" | df$s == "2"]
df1 <- df1[c(1,2,3,4,5,6,7,8),]
df1 <- df1[1:8,]
colData(df1) <- subset(colData(df1)[1:8],c(1,2,3,4,5,6,7,8))
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- parathyroidGenesSE
s <- as.character(df$sample)
s <- substring(s, nchar(s))
colData(parathyroidGenesSE)$s <- s
df1 <- subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
df1 <- df1[,df1$s =="6"|df1$s =="4"| df$s =="1" | df$s == "2"]
df1 <- df1[c(1,2,3,4,5,6,7,8),]
df1 <- df1[1:8,]
colData(df1) <- subset(colData(df1)[1:8],c(1,2,3,4,5,6,7,8))
df1$Comparision <- c("a","a","a","a","b","b","b","b")
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- parathyroidGenesSE
s <- as.character(df$sample)
s <- substring(s, nchar(s))
colData(parathyroidGenesSE)$s <- s
df1 <- subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
df1 <- df1[,df1$s =="6"|df1$s =="4"| df$s =="1" | df$s == "2"]
df1 <- df1[c(1,2,3,4,5,6,7,8),]
df1 <- df1[1:8,]
colData(df1) <- subset(colData(df1)[1:8],c(1,2,3,4,5,6,7,8))
df1$sample <- as.character(df1$sample)
df1 <- filter(df1, df1$sample != "SRS308886")
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- parathyroidGenesSE
s <- as.character(df$sample)
s <- substring(s, nchar(s))
colData(parathyroidGenesSE)$s <- s
df1 <- subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
df1 <- df1[,df1$s =="6"|df1$s =="4"| df$s =="1" | df$s == "2"]
df1 <- df1[c(1,2,3,4,5,6,7,8),]
df1 <- df1[1:8,]
colData(df1) <- subset(colData(df1)[1:8],c(1,2,3,4,5,6,7,8))
df1$sample <- as.character(df1$sample)
filter(df1, df1$sample != "SRS308886")
require(parathyroidSE)
require(DESeq2)
install.packages("ggplot2")
install.packages("pheatmap")
install.packages("EnhancedVolcano")
install.packages("apeglm")
install.packages("tidyverse")
install.packages("AnnotationDbi")
df <- parathyroidGenesSE
s <- as.character(df$sample)
s <- substring(s, nchar(s))
colData(parathyroidGenesSE)$s <- s
df1 <- subset(parathyroidGenesSE,s=="6"|s=="4"|s=="1"|s=="2")
df1 <- df1[,df1$s =="6"|df1$s =="4"| df$s =="1" | df$s == "2"]
df1 <- df1[c(1,2,3,4,5,6,7,8),]
df1 <- df1[1:8,]
colData(df1) <- subset(colData(df1)[1:8],c(1,2,3,4,5,6,7,8))
df1$sample <- as.character(df1$sample)
df1 <- df1[,df1$sample != "STS308886"]
df1
